function toggleNameForm(){$("#login-screen").toggle()}function toggleChatWindow(){$("#main-chat-screen").toggle()}function zeroPad(e,o){for(var t=e+"";t.length<o;)t="0"+t;return t}function timeFormat(e){var o=new Date(e);return zeroPad(o.getHours(),2)+":"+zeroPad(o.getMinutes(),2)+":"+zeroPad(o.getSeconds(),2)+" "}$(document).ready(function(){function e(){n=!1,o.emit("typing",!1)}$(".real-modal").click(function(){$("#modal1").openModal()});

  //Please replace IP here
  var o=io.connect("10.24.197.188:3000"),t=null;


  $("form").submit(function(e){e.preventDefault()}),$("#conversation").bind("DOMSubtreeModified",function(){$("#conversation").animate({scrollTop:$("#conversation")[0].scrollHeight})}),$("#main-chat-screen").hide(),$("#errors").hide(),$("#name").focus(),$("#join").attr("disabled","disabled"),""===$("#name").val()&&$("#join").attr("disabled","disabled"),$("#nameForm").submit(function(){var e=$("#name").val(),t="desktop";navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)&&(t="mobile"),""===e||e.length<2?($("#errors").empty(),$("#errors").append("Please enter a name"),$("#errors").show()):(o.emit("joinserver",e,t),toggleNameForm(),toggleChatWindow(),$("#msg").focus())}),$("#name").keypress(function(){var e=$("#name").val();e.length<2?$("#join").attr("disabled","disabled"):($("#errors").empty(),$("#errors").hide(),$("#join").removeAttr("disabled"))}),$("#chatForm").submit(function(){var e=$("#msg").val();""!==e&&(o.emit("send",(new Date).getTime(),e),$("#msg").val(""))});var n=!1,s=void 0;$("#msg").keypress(function(a){13!==a.which&&(n===!1&&null!==t&&$("#msg").is(":focus")?(n=!0,o.emit("typing",!0)):(clearTimeout(s),s=setTimeout(e,5e3)))}),o.on("isTyping",function(o){o.isTyping?0===$("#"+o.person).length&&($("#updates").append("<li id='"+o.person+"'><span class='text-muted'><small><i class='fa fa-keyboard-o'></i> "+o.person+" is typing.</small></li>"),s=setTimeout(e,5e3)):$("#"+o.person).remove()}),$("#showCreateRoom").click(function(){$("#createRoomForm").toggle()}),$("#createRoomBtn").click(function(){var e=!1,t=$("#createRoomName").val();o.emit("check",t,function(n){e=n.result,e?($("#errors").empty(),$("#errors").show(),$("#errors").append("Room <i>"+t+"</i> already exists")):t.length>0&&(o.emit("createRoom",t),$("#errors").empty(),$("#errors").hide())})}),$("#rooms").on("click",".joinRoomBtn",function(){var e=($(this).siblings("span").text(),$(this).attr("id"));o.emit("joinRoom",e)}),$("#rooms").on("click",".removeRoomBtn",function(){var e=($(this).siblings("span").text(),$(this).attr("id"));o.emit("removeRoom",e),$("#createRoom").show()}),$("#leave").click(function(){var e=t;o.emit("leaveRoom",e),$("#createRoom").show()}),$("#people").on("click",".whisper",function(){var e=$(this).siblings("span").text();$("#msg").val("w:"+e+":"),$("#msg").focus()}),o.on("exists",function(e){$("#errors").empty(),$("#errors").show(),$("#errors").append(e.msg+" Try <strong>"+e.proposedName+"</strong>"),toggleNameForm(),toggleChatWindow()}),o.on("joined",function(){function e(e){console.log(e)}function t(e){var t=e.coords.latitude,n=e.coords.longitude;$.ajax({type:"GET",url:"http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20geo.placefinder%20where%20text%3D%22"+t+"%2C"+n+"%22%20and%20gflags%3D%22R%22&format=json",dataType:"json",success:function(e){o.emit("countryUpdate",{country:e.query.results.Result.countrycode})}})}$("#errors").hide(),navigator.geolocation?navigator.geolocation.getCurrentPosition(t,e,{enableHighAccuracy:!0}):($("#errors").show(),$("#errors").append("Your browser is ancient and it doesn't support GeoLocation."))}),o.on("history",function(e){0!==e.length?($("#msgs").append("<li class=\"collection-item\"><strong><span class='green-text text-darken-2'>Last 10 messages:</li>"),$.each(e,function(e,o){$("#msgs").append("<li class=\"collection-item\"><span class='black-text'>"+o+"</span></li>")})):$("#msgs").append("<li class=\"collection-item\"><strong><span class='red-text text-darken-2'>No past messages in this room.</li>")}),o.on("update",function(e){$("#msgs").append('<li class="collection-item">'+e+"</li>")}),o.on("update-people",function(e){$("#people").empty(),$("#people").append('<li class="collection-item active">People online <span class="badge new">'+e.count+"</span></li>"),$.each(e.people,function(e,o){html="country"in o?'<img class="flag flag-'+o.country+'"/>':"",$("#people").append('<li class="collection-item avatar"><i class="material-icons circle green">insert_chart</i><span class="title">'+o.name+'</span> <p><i class="fa fa-'+o.device+'"></i><br> '+html+' <a href="#!" class="secondary-content"><i class="material-icons">contacts</i></a></p></li>')})}),o.on("chat",function(o,t,n){$("#msgs").append('<li class="collection-item avatar"> <i class="material-icons circle">account_circle</i><span class="title">'+t.name+"</span><br><p><strong><span class='blue-text text-darken-2'>"+timeFormat(o)+'</span></strong></p><span class="secondary-content"> '+n+"</span></li>"),$("#"+t.name).remove(),clearTimeout(s),s=setTimeout(e,0)}),o.on("roomList",function(e){$("#rooms").text(""),$("#rooms").append('<li class="collection-item active">List of rooms <span class="badge new">'+e.count+"</span></li>"),jQuery.isEmptyObject(e.rooms)?$("#rooms").append('<li class="list-group-item"><h6 class="center-align">There are no rooms yet.</h6></li>'):$.each(e.rooms,function(e,o){var t='<p> <a href="#!" class="joinRoomBtn tooltipped" data-position="bottom" data-delay="50" data-tooltip="I am tooltip"  id='+e+'><i class="material-icons green-text">input</i></a> <a href="#!" class="secondary-contents removeRoomBtn" id='+e+'><i class="material-icons red-text darken-2">delete</i></a></p>';$("#rooms").append("<li id="+e+' class="collection-item avatar"><i class="material-icons circle">room</i><span class="title">'+o.name+"</span> "+t+"</li>")})}),o.on("sendRoomID",function(e){t=e.id}),o.on("disconnect",function(){$("#msgs").append("<li><strong><span class='red-text'>The server is not available</span></strong></li>"),$("#msg").attr("disabled","disabled"),$("#send").attr("disabled","disabled")})});